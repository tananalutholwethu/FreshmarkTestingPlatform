<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Issue Details - FreshMark Testing Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/css/lightbox.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-bug me-2"></i>FreshMark Testing
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-home me-1"></i>Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-project-diagram me-1"></i>Projects</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="#"><i class="fas fa-bug me-1"></i>Issues</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-trophy me-1"></i>Leaderboard</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link position-relative" href="#">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge">3</span>
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle me-1"></i>John Developer
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i>Profile</a></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Settings</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid mt-4">
        <div class="row">
            <!-- Left Column - Issue Details -->
            <div class="col-lg-8">
                <!-- Issue Header -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-white border-bottom">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h4 class="mb-2">
                                    <span class="badge bg-danger me-2">Critical</span>
                                    <span class="text-muted">#ISS-047</span>
                                </h4>
                                <h5 class="mb-0">Login page crashes when password contains special characters</h5>
                            </div>
                            <div class="dropdown">
                                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                    <i class="fas fa-ellipsis-v"></i>
                                </button>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li><a class="dropdown-item" href="#"><i class="fas fa-edit me-2"></i>Edit Issue</a></li>
                                    <li><a class="dropdown-item" href="#"><i class="fas fa-link me-2"></i>Copy Link</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item text-danger" href="#"><i class="fas fa-times-circle me-2"></i>Close Issue</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Status and Meta Info -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <p class="mb-2">
                                    <strong>Status:</strong>
                                    <span class="badge status-badge status-claimed ms-2">Claimed</span>
                                </p>
                                <p class="mb-2">
                                    <strong>Type:</strong>
                                    <i class="fas fa-bug text-danger me-1"></i>Bug
                                </p>
                                <p class="mb-2">
                                    <strong>Project:</strong>
                                    <a href="#">FMS-CRM</a>
                                </p>
                            </div>
                            <div class="col-md-6">
                                <p class="mb-2">
                                    <strong>Reported by:</strong>
                                    <a href="#">Sarah Tester</a>
                                </p>
                                <p class="mb-2">
                                    <strong>Claimed by:</strong>
                                    <a href="#">You</a>
                                </p>
                                <p class="mb-2">
                                    <strong>Time spent:</strong>
                                    <span id="time-display" class="text-primary fw-bold">2.5 hours</span>
                                </p>
                            </div>
                        </div>

                        <!-- Issue Description -->
                        <div class="mb-4">
                            <h6 class="fw-bold">Description</h6>
                            <p>When attempting to log in with a password that contains special characters like @, #, $, the login page crashes with a white screen error. This happens consistently across all browsers tested.</p>
                        </div>

                        <!-- Steps to Reproduce -->
                        <div class="mb-4">
                            <h6 class="fw-bold">Steps to Reproduce</h6>
                            <ol>
                                <li>Navigate to login page (https://test.freshmark.com/login)</li>
                                <li>Enter valid username</li>
                                <li>Enter password with special characters (e.g., "Pass@word#123")</li>
                                <li>Click "Login" button</li>
                                <li>Observe white screen crash</li>
                            </ol>
                        </div>

                        <!-- Expected vs Actual -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <h6 class="fw-bold text-success">Expected Behavior</h6>
                                <p>User should be logged in successfully and redirected to the dashboard.</p>
                            </div>
                            <div class="col-md-6">
                                <h6 class="fw-bold text-danger">Actual Behavior</h6>
                                <p>Page crashes and displays blank white screen. Browser console shows PHP fatal error.</p>
                            </div>
                        </div>

                        <!-- Environment Info -->
                        <div class="mb-4">
                            <h6 class="fw-bold">Environment</h6>
                            <div class="d-flex gap-3">
                                <span><i class="fas fa-globe me-1"></i><strong>Browser:</strong> Chrome 118</span>
                                <span><i class="fas fa-desktop me-1"></i><strong>Device:</strong> Desktop</span>
                                <span><i class="fas fa-laptop me-1"></i><strong>OS:</strong> Windows 11</span>
                            </div>
                        </div>

                        <!-- Screenshots -->
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3">Screenshots (3)</h6>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <a href="https://via.placeholder.com/800x600/EF4444/FFFFFF?text=Login+Screen" data-lightbox="issue-screenshots" data-title="Login screen before crash">
                                        <img src="https://via.placeholder.com/300x200/EF4444/FFFFFF?text=Login+Screen" class="img-thumbnail screenshot-thumb" alt="Screenshot 1">
                                    </a>
                                    <p class="small text-muted mt-1">Login screen before crash</p>
                                </div>
                                <div class="col-md-4">
                                    <a href="https://via.placeholder.com/800x600/F59E0B/FFFFFF?text=White+Screen+Error" data-lightbox="issue-screenshots" data-title="White screen error after login">
                                        <img src="https://via.placeholder.com/300x200/F59E0B/FFFFFF?text=White+Screen" class="img-thumbnail screenshot-thumb" alt="Screenshot 2">
                                    </a>
                                    <p class="small text-muted mt-1">White screen error</p>
                                </div>
                                <div class="col-md-4">
                                    <a href="https://via.placeholder.com/800x600/3B82F6/FFFFFF?text=Console+Error" data-lightbox="issue-screenshots" data-title="Browser console error">
                                        <img src="https://via.placeholder.com/300x200/3B82F6/FFFFFF?text=Console+Error" class="img-thumbnail screenshot-thumb" alt="Screenshot 3">
                                    </a>
                                    <p class="small text-muted mt-1">Console error message</p>
                                </div>
                            </div>
                        </div>

                        <!-- Work Timer -->
                        <div class="work-timer-section mb-4">
                            <h6 class="fw-bold mb-3">Work Timer</h6>
                            <div class="d-flex align-items-center gap-3">
                                <button class="btn btn-success" id="start-timer">
                                    <i class="fas fa-play me-2"></i>Start
                                </button>
                                <button class="btn btn-warning" id="pause-timer" disabled>
                                    <i class="fas fa-pause me-2"></i>Pause
                                </button>
                                <button class="btn btn-danger" id="stop-timer" disabled>
                                    <i class="fas fa-stop me-2"></i>Stop
                                </button>
                                <div class="ms-auto">
                                    <span class="badge bg-light text-dark fs-5 px-3 py-2" id="timer-display">00:00:00</span>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-flex gap-2 flex-wrap">
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#workLogModal">
                                <i class="fas fa-check-circle me-2"></i>Mark as Fixed
                            </button>
                            <button class="btn btn-outline-secondary">
                                <i class="fas fa-comment me-2"></i>Add Comment
                            </button>
                            <button class="btn btn-outline-warning" id="abandon-issue-btn">
                                <i class="fas fa-undo me-2"></i>Abandon Issue
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Comments Section -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-white">
                        <h6 class="mb-0"><i class="fas fa-comments me-2"></i>Comments (2)</h6>
                    </div>
                    <div class="card-body">
                        <!-- Comment 1 -->
                        <div class="comment-item mb-3 pb-3 border-bottom">
                            <div class="d-flex">
                                <div class="flex-shrink-0">
                                    <div class="avatar-circle bg-primary">JD</div>
                                </div>
                                <div class="flex-grow-1 ms-3">
                                    <div class="d-flex justify-content-between">
                                        <h6 class="mb-1">John Developer</h6>
                                        <small class="text-muted">2 hours ago</small>
                                    </div>
                                    <p class="mb-0">I've identified the issue - it's related to SQL injection prevention. The special characters aren't being properly escaped before the query. Working on a fix now.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Comment 2 -->
                        <div class="comment-item mb-3">
                            <div class="d-flex">
                                <div class="flex-shrink-0">
                                    <div class="avatar-circle bg-success">ST</div>
                                </div>
                                <div class="flex-grow-1 ms-3">
                                    <div class="d-flex justify-content-between">
                                        <h6 class="mb-1">Sarah Tester</h6>
                                        <small class="text-muted">3 hours ago</small>
                                    </div>
                                    <p class="mb-0">This is blocking multiple test scenarios. Please prioritize. Also happens with the @ symbol in email format passwords.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Add Comment Form -->
                        <div class="add-comment-form">
                            <textarea class="form-control" id="comment-text" rows="3" placeholder="Add a comment..."></textarea>
                            <button class="btn btn-primary btn-sm mt-2" id="submit-comment">
                                <i class="fas fa-paper-plane me-2"></i>Post Comment
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column - Sidebar -->
            <div class="col-lg-4">
                <!-- Timeline -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-white">
                        <h6 class="mb-0"><i class="fas fa-history me-2"></i>Activity Timeline</h6>
                    </div>
                    <div class="card-body p-0">
                        <ul class="timeline">
                            <li class="timeline-item">
                                <div class="timeline-marker bg-primary"></div>
                                <div class="timeline-content">
                                    <p class="mb-1"><strong>John Developer</strong> claimed this issue</p>
                                    <small class="text-muted">1 hour ago</small>
                                </div>
                            </li>
                            <li class="timeline-item">
                                <div class="timeline-marker bg-warning"></div>
                                <div class="timeline-content">
                                    <p class="mb-1"><strong>Status changed</strong> from Unclaimed to Claimed</p>
                                    <small class="text-muted">1 hour ago</small>
                                </div>
                            </li>
                            <li class="timeline-item">
                                <div class="timeline-marker bg-info"></div>
                                <div class="timeline-content">
                                    <p class="mb-1"><strong>John Developer</strong> added a comment</p>
                                    <small class="text-muted">2 hours ago</small>
                                </div>
                            </li>
                            <li class="timeline-item">
                                <div class="timeline-marker bg-success"></div>
                                <div class="timeline-content">
                                    <p class="mb-1"><strong>Sarah Tester</strong> created this issue</p>
                                    <small class="text-muted">4 hours ago</small>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Issue Stats -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-white">
                        <h6 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Issue Stats</h6>
                    </div>
                    <div class="card-body">
                        <div class="stat-item mb-3">
                            <div class="d-flex justify-content-between">
                                <span class="text-muted">Created</span>
                                <strong>4 hours ago</strong>
                            </div>
                        </div>
                        <div class="stat-item mb-3">
                            <div class="d-flex justify-content-between">
                                <span class="text-muted">Last Updated</span>
                                <strong>1 hour ago</strong>
                            </div>
                        </div>
                        <div class="stat-item mb-3">
                            <div class="d-flex justify-content-between">
                                <span class="text-muted">Time Spent</span>
                                <strong class="text-primary">2.5 hours</strong>
                            </div>
                        </div>
                        <div class="stat-item mb-3">
                            <div class="d-flex justify-content-between">
                                <span class="text-muted">Reopen Count</span>
                                <strong>0</strong>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="d-flex justify-content-between">
                                <span class="text-muted">Potential Points</span>
                                <strong class="text-warning">25 pts</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Work Log Modal -->
    <div class="modal fade" id="workLogModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-clipboard-check me-2"></i>Submit Work Log</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="work-log-form">
                        <!-- CSRF Token (will be generated by PHP) -->
                        <input type="hidden" name="csrf_token" value="sample_csrf_token">
                        <input type="hidden" name="issue_id" value="47">

                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            All fields are mandatory and will be added to your timesheet report.
                        </div>

                        <!-- What did you fix -->
                        <div class="mb-3">
                            <label for="work_description" class="form-label">
                                What did you fix? <span class="text-danger">*</span>
                            </label>
                            <textarea 
                                class="form-control" 
                                id="work_description" 
                                name="work_description" 
                                rows="3" 
                                required
                                minlength="100"
                                placeholder="Describe in detail what you fixed... (minimum 100 characters)"></textarea>
                            <div class="form-text">
                                <span id="work_description_count">0</span> / 100 characters (minimum)
                            </div>
                        </div>

                        <!-- Files Changed -->
                        <div class="mb-3">
                            <label for="files_changed" class="form-label">
                                Files/Modules Changed <span class="text-danger">*</span>
                            </label>
                            <textarea 
                                class="form-control" 
                                id="files_changed" 
                                name="files_changed" 
                                rows="2" 
                                required
                                minlength="20"
                                placeholder="List the files or modules you modified... (minimum 20 characters)"></textarea>
                            <div class="form-text">
                                <span id="files_changed_count">0</span> / 20 characters (minimum)
                            </div>
                        </div>

                        <!-- Solution Approach -->
                        <div class="mb-3">
                            <label for="solution_approach" class="form-label">
                                How did you solve it? <span class="text-danger">*</span>
                            </label>
                            <textarea 
                                class="form-control" 
                                id="solution_approach" 
                                name="solution_approach" 
                                rows="3" 
                                required
                                minlength="50"
                                placeholder="Explain your solution approach... (minimum 50 characters)"></textarea>
                            <div class="form-text">
                                <span id="solution_approach_count">0</span> / 50 characters (minimum)
                            </div>
                        </div>

                        <!-- Testing Done -->
                        <div class="mb-3">
                            <label for="testing_done" class="form-label">
                                What testing did you do? <span class="text-danger">*</span>
                            </label>
                            <textarea 
                                class="form-control" 
                                id="testing_done" 
                                name="testing_done" 
                                rows="3" 
                                required
                                minlength="50"
                                placeholder="Describe how you tested your fix... (minimum 50 characters)"></textarea>
                            <div class="form-text">
                                <span id="testing_done_count">0</span> / 50 characters (minimum)
                            </div>
                        </div>

                        <!-- Testing Instructions -->
                        <div class="mb-3">
                            <label for="testing_instructions" class="form-label">
                                Testing Instructions for Tester <span class="text-danger">*</span>
                            </label>
                            <textarea 
                                class="form-control" 
                                id="testing_instructions" 
                                name="testing_instructions" 
                                rows="3" 
                                required
                                minlength="50"
                                placeholder="Provide step-by-step testing instructions... (minimum 50 characters)"></textarea>
                            <div class="form-text">
                                <span id="testing_instructions_count">0</span> / 50 characters (minimum)
                            </div>
                        </div>

                        <!-- Blockers (Optional) -->
                        <div class="mb-3">
                            <label for="blockers_encountered" class="form-label">
                                Blockers Encountered <span class="text-muted">(Optional)</span>
                            </label>
                            <textarea 
                                class="form-control" 
                                id="blockers_encountered" 
                                name="blockers_encountered" 
                                rows="2" 
                                placeholder="Any challenges or blockers you faced..."></textarea>
                        </div>

                        <!-- Time Spent -->
                        <div class="mb-3">
                            <label for="time_spent" class="form-label">
                                Time Spent (hours) <span class="text-danger">*</span>
                            </label>
                            <input 
                                type="number" 
                                class="form-control" 
                                id="time_spent" 
                                name="time_spent" 
                                required
                                min="0.1"
                                max="24"
                                step="0.1"
                                placeholder="e.g., 2.5">
                            <div class="form-text">Enter hours (0.1 - 24 hours)</div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="submit-work-log">
                        <i class="fas fa-check me-2"></i>Submit & Request Retest
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/js/lightbox.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="scripts.js"></script>
</body>
</html>